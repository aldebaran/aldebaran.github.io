
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Coding Convention &mdash; qi SDK Documentation 2.2.0.55 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.2.0.55',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="qi SDK Documentation 2.2.0.55 documentation" href="../index.html" />
    <link rel="up" title="Design Documents" href="index.html" />
    <link rel="prev" title="Network Binary Protocol" href="network-binary-protocol.html" />
 
<script>
$(window).ready(function () {
    var width_label = 0;
    $('dl.function-index dt > span').each(function () {
        $(this).css('width', 'auto');
        width_label = Math.max(width_label, $(this).width());
    }).width(width_label + 30);
    $('.sig-paren').width('auto');
})

</script>


<script type="text/javascript" src="/static/js/ga-status.js"></script>



  </head>
  <body>

    <div class="document">
  <div id="custom-doc" class="yui-t3">
    <div id="hd">
      <h1><a href="../index.html">qi SDK Documentation 2.2.0.55 documentation</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../index.html">Home</a>
         |
        <a title="Site map" href="../contents.html">Site map</a>
         |
        <a title="Search" href="../search.html">Search</a>
         |
        <a title="Index" href="../genindex.html">Index</a>
      </div>
      <div class="nav">
    &laquo; <a href="network-binary-protocol.html" title="Network Binary Protocol">previous</a>
     |
    <a href="index.html" title="Design Documents" accesskey="U">up</a></div>
    </div>

    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="design-codingstyle">
            
  <div class="section" id="coding-convention">
<span id="std-code-convention"></span><h1>Coding Convention<a class="headerlink" href="#coding-convention" title="Permalink to this headline">¶</a></h1>
<div class="section" id="backward-compatibility">
<h2>Backward Compatibility<a class="headerlink" href="#backward-compatibility" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Qt API Design Principles</dt>
<dd><a class="reference external" href="http://wiki.qt-project.org/API_Design_Principles">http://wiki.qt-project.org/API_Design_Principles</a></dd>
<dt>Qt ABI thoughts</dt>
<dd><a class="reference external" href="http://labs.qt.nokia.com/2009/08/12/some-thoughts-on-binary-compatibility/">http://labs.qt.nokia.com/2009/08/12/some-thoughts-on-binary-compatibility/</a></dd>
<dt>C++ Tips and Tricks for Mac OS X</dt>
<dd><a class="reference external" href="https://developer.apple.com/library/mac/#technotes/tn2185/_index.html">https://developer.apple.com/library/mac/#technotes/tn2185/_index.html</a></dd>
<dt>Potential Errors Passing CRT Objects Across DLL Boundaries</dt>
<dd><a class="reference external" href="http://msdn.microsoft.com/en-us/library/ms235460.aspx">http://msdn.microsoft.com/en-us/library/ms235460.aspx</a></dd>
</dl>
</div>
<div class="section" id="naming-convention">
<h2>Naming convention<a class="headerlink" href="#naming-convention" title="Permalink to this headline">¶</a></h2>
<p>Headers go into &lt;libname&gt;/*</p>
<blockquote>
<div><ul class="simple">
<li>we want the same layout when headers are installed and are in the source tree</li>
<li>we want to prefix by the library name to avoid headers clash, remember that we want to install in /usr/include sometimes</li>
</ul>
</div></blockquote>
<p>Sources and private headers goes into &lt;src&gt;/*</p>
<blockquote>
<div><ul class="simple">
<li>That allows us to isolate public code that need a particular attention</li>
<li>It&#8217;s easier to grep only in public headers</li>
</ul>
</div></blockquote>
<p>Private classes go into &lt;src&gt;/*</p>
<p>Private implementation headers should be named &#8216;&lt;classname&gt;_p.hpp&#8217;</p>
<blockquote>
<div><ul class="simple">
<li>this distinguishes public and private headers, otherwise we can have two files with the same name which is not pratical.</li>
<li>furthermore this denotates that the content should never be public, it&#8217;s the private part of a class.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>Qt classes are not in a namespace</li>
<li>Qt classes are prefixed with &#8216;Qi&#8217;</li>
</ul>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>For the public <em>foo</em> class and the private <em>oups</em> class in the <em>bar</em> library we have:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bar/foo.hpp</span>

<span class="go">src/foo.cpp</span>
<span class="go">src/foo_p.hpp</span>
<span class="go">src/oups.cpp</span>
<span class="go">src/oups.hpp</span>
<span class="go">src/oups_p.hpp (optional)</span>

<span class="go">qt/bar/qt/qifoo.h</span>

<span class="go">qt/src/qifoo.cpp</span>
<span class="go">qt/src/qifoo_p.h</span>
</pre></div>
</div>
<p>This gives us the following objects:</p>
<p>STL:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;bar/foo.hpp&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">qi</span><span class="o">::</span><span class="n">Foo</span> <span class="n">foo</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>QT:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;bar/qt/qifoo.h&gt;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">QiFoo</span> <span class="n">foo</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="headers">
<h2>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h2>
<p>Public headers must not include public headers from other libraries. This
ensures binary compatibility.</p>
<p>Public headers must be enclosed within brackets &lt;&gt; when included.</p>
<p>On the other hand, private headers must be enclosed within double quotes &#8220;&#8221; when
included.</p>
</div>
<div class="section" id="header-include-statement">
<h2>Header include statement<a class="headerlink" href="#header-include-statement" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">If a header is <strong>not provided by the project</strong>, then the include statement
<strong>must</strong> be:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;bar/foo.h&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Else if a header is <strong>provided by the project</strong> and <strong>gets installed</strong>, so this is a
<em>public header</em>, then the include statement <strong>must</strong> be:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;bar/foo.h&gt;</span>
</pre></div>
</div>
</li>
<li><p class="first">Otherwise, this is a <em>private header</em> <strong>provided by the project</strong> and
<strong>only used in this project</strong> (e.i. <em>never gets installed</em>), then the include
statement <strong>must</strong> be:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &quot;bar/foo.h&quot;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="export-symbol">
<h2>Export symbol<a class="headerlink" href="#export-symbol" title="Permalink to this headline">¶</a></h2>
<p>All public functions and classes should be exported using &lt;LIBNAME&gt;_API macro. This macro should be unique to the library and never be used by others libraries.</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#include &lt;bar/api.hpp&gt;</span>

<span class="k">class</span> <span class="nc">BAR_API</span> <span class="n">Foo</span> <span class="p">{</span>
<span class="p">};</span>
</pre></div>
</div>
<p>For each library you will have to define &lt;library&gt;/api.hpp</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="cp">#pragma once</span>
<span class="cp">#ifndef _BAR_API_HPP_</span>
<span class="cp">#define _BAR_API_HPP_</span>

<span class="cp">#include &lt;qi/macro.hpp&gt;</span>

<span class="cp">#define BAR_API QI_LIB_API(bar)</span>

<span class="cp">#endif  </span><span class="c1">// _BAR_API_HPP_</span>
</pre></div>
</div>
<p>Please remember to export nested class</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">BAR_API</span> <span class="n">Foo</span>
<span class="p">{</span>
<span class="nl">public:</span>

  <span class="n">Foo</span><span class="p">();</span>
  <span class="o">~</span><span class="n">Foo</span><span class="p">();</span>

  <span class="k">class</span> <span class="nc">BAR_API</span> <span class="n">Bar</span> <span class="c1">// BAR_API is mandatory here</span>
  <span class="p">{</span>
  <span class="nl">public:</span>

    <span class="n">Bar</span><span class="p">();</span>
    <span class="o">~</span><span class="n">Bar</span><span class="p">();</span>
  <span class="p">};</span>

<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="private-implementation">
<h2>Private Implementation<a class="headerlink" href="#private-implementation" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Use private implementation where applicable.</li>
<li>Still reserve a pointer instead if you dont use it. (for future use, see
example two).</li>
<li>Classes should be named &lt;classname&gt;Private.</li>
<li>A pointer &#8216;_p&#8217; should be added into the class.</li>
</ul>
<p>When a class has a private implementation, the copy constructor <em>must</em> be either
implemented, either disabled - <em>ie.</em> defined in the private section of the class.</p>
<div class="section" id="example-with-pimpl">
<h3>Example with Pimpl<a class="headerlink" href="#example-with-pimpl" title="Permalink to this headline">¶</a></h3>
<p>bar/foo.hpp:</p>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FooPrivate</span><span class="p">;</span>
<span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span>
  <span class="n">FooPrivate</span> <span class="o">*</span><span class="n">_p</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="example-without-pimpl">
<h3>Example without Pimpl<a class="headerlink" href="#example-without-pimpl" title="Permalink to this headline">¶</a></h3>
<div class="highlight-cpp"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Foo</span> <span class="p">{</span>
<span class="nl">public:</span>

<span class="nl">protected:</span>
  <span class="c1">//could be used to create a future pimpl if needed without breaking ABI</span>
  <span class="kt">void</span> <span class="o">*</span><span class="n">_reserved</span><span class="p">;</span>
  <span class="kt">int</span>   <span class="n">_mymember</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="struct">
<h2>Struct<a class="headerlink" href="#struct" title="Permalink to this headline">¶</a></h2>
<p>You can expose struct but they should only contains POD. If a struct have a member which a class (or worst) a STL class, Windows wont be happy, and you will have to link
the exe and the dll with the same VC runtime, in the same configuration (release/debug). Prefer Pimpl in this case.</p>
</div>
<div class="section" id="exception">
<h2>Exception<a class="headerlink" href="#exception" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="http://stackoverflow.com/questions/4756944/c-dll-plugin-interface/4757105#4757105">http://stackoverflow.com/questions/4756944/c-dll-plugin-interface/4757105#4757105</a></p>
<p>Exceptions issues:</p>
<ul class="simple">
<li>may not be available on all platforms</li>
<li>it&#8217;s not really compatible with asynchronous design, where error reporting should be asynchronous too, but the error can catched at the caller place, and rethrow at the callee place. (qi::Future can help having both)</li>
<li>exceptions increase the library size</li>
<li>it&#8217;s really hard to write exception-safe code. (RAII really help here)</li>
<li>Exception catching of a user defined type in a binary other than the one which threw the exception requires a typeinfo lookup. (and rtti do not work well across dll boundary <a class="reference external" href="http://gcc.gnu.org/faq.html#dso">http://gcc.gnu.org/faq.html#dso</a>)</li>
<li>it break ABI: memory allocated in one place should be deallocated in the same place (remember that object do not have the same size in release/debug with MSVC), so if user catch a ref, this can crash.</li>
<li>Avoiding leak is really hard (all function should handle exceptions, again RAII really help)</li>
</ul>
<p>Example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">A</span> <span class="o">*</span><span class="n">a</span> <span class="o">=</span> <span class="k">new</span> <span class="n">A</span><span class="p">();</span>
<span class="c1">//this leak a A*</span>
<span class="n">functionthatthrow</span><span class="p">();</span>
<span class="k">delete</span> <span class="n">a</span><span class="p">;</span>
</pre></div>
</div>
<p>This could be fixed with a RAII smart pointer class:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">//this could be rewriten with smart pointer to avoid error</span>
<span class="n">boost</span><span class="o">::</span><span class="n">shared_ptr</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">boost</span><span class="o">::</span><span class="n">make_shared</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span><span class="p">();</span>

<span class="n">functionthatthrow</span><span class="p">();</span>
<span class="c1">//a is cleanup here whatever happened.</span>
</pre></div>
</div>
<p>even more vicious:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">//GenericObject that throw in operator= sometime</span>
<span class="k">class</span> <span class="nc">EvilObject</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">list</span><span class="o">&lt;</span><span class="n">EvilObject</span><span class="o">&gt;</span> <span class="n">evilList</span><span class="p">;</span>

<span class="c1">//simple function, that do not look evil, but can throw nevertheless,</span>
<span class="c1">//but can you guess what?</span>
<span class="kt">void</span> <span class="nf">functionthatdonotthrow</span><span class="p">(</span><span class="k">const</span> <span class="n">EvilObject</span> <span class="o">&amp;</span><span class="n">eo</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">evilList</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">eo</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="n">EvilObject</span> <span class="o">*</span><span class="n">eo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">EvilObject</span><span class="p">;</span>
  <span class="c1">//leak, but you can&#39;t guess that reading functionthatdonotthrow</span>
  <span class="n">functionthatdonotthrow</span><span class="p">(</span><span class="o">*</span><span class="n">eo</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once you have exception you should use RAII everywhere to avoid leak.</p>
<p>So use exception with caution and prefer a simple hierarchy over a complicated one.
Do not hesitate to use std::runtime_error.
Never throw an exception not defined in your lib, except the one provided by the stdexcept header.</p>
</div>
<div class="section" id="iterators">
<h2>Iterators<a class="headerlink" href="#iterators" title="Permalink to this headline">¶</a></h2>
<p>When naming an iterator, simply append &#8220;It&#8221; after the name of the container.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">primeNumbers</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;::</span><span class="n">iterator</span> <span class="n">primeNumbersIt</span><span class="p">;</span>
</pre></div>
</div>
</div>
<div class="section" id="enum">
<h2>Enum<a class="headerlink" href="#enum" title="Permalink to this headline">¶</a></h2>
<p>The name of the enumeration must be singular.</p>
<p>The enumeration values must be prefixed by the name of the enumeration followed by an underscore.</p>
<p>Precise each number and never reorder existing enumerations for ABI compatibility.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Message</span> <span class="p">{</span>
<span class="nl">public:</span>

  <span class="k">enum</span> <span class="n">Type</span> <span class="p">{</span>
    <span class="n">Type_Call</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">Type_Error</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">Type_Answer</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
    <span class="n">Type_Event</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="p">};</span>

<span class="p">};</span>
</pre></div>
</div>
<p>Always prefer enumerations to booleans for readability.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">// bad: cannot understand just by reading the line</span>
<span class="n">Client</span> <span class="nf">ds</span><span class="p">(</span><span class="s">&quot;ip&quot;</span><span class="p">,</span> <span class="nb">true</span><span class="p">);</span>
<span class="c1">// GOOD: easy to read, ok this is keepalive.</span>
<span class="n">Client</span> <span class="nf">ds</span><span class="p">(</span><span class="s">&quot;ip&quot;</span><span class="p">,</span> <span class="n">Connection_KeepAlive</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="members">
<h2>Members<a class="headerlink" href="#members" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Private members names should be prefixed with underscores.</li>
</ul>
</div>
<div class="section" id="arguments">
<h2>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">¶</a></h2>
<p>If the argument is IN-OUT then use pointer and avoid reference. The code that use the function is clearer to look at.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">int</span>     <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">result</span><span class="p">;</span>
<span class="kt">bool</span>    <span class="n">check</span><span class="p">;</span>

<span class="c1">//the &amp; show that the value can be modified</span>
<span class="n">check</span> <span class="o">=</span> <span class="n">computeButCanFail</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">result</span><span class="p">);</span>

<span class="c1">//bad... we dont know value will be modified</span>
<span class="n">check</span> <span class="o">=</span> <span class="n">computeButCanFail</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">result</span><span class="p">);</span>
</pre></div>
</div>
<p>If the type is a POD (bool, char, short, int, float, double, etc...) use:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">setValue</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">);</span>
</pre></div>
</div>
<p>In all other case use const ref.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="kt">void</span> <span class="nf">setValue</span><span class="p">(</span><span class="k">const</span> <span class="n">MyClass</span> <span class="o">&amp;</span><span class="n">myclass</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="virtual">
<h2>Virtual<a class="headerlink" href="#virtual" title="Permalink to this headline">¶</a></h2>
<p>All class with virtuals should have a virtual destructor to avoid leak.</p>
</div>
<div class="section" id="interface">
<h2>Interface<a class="headerlink" href="#interface" title="Permalink to this headline">¶</a></h2>
<p>Always declare the destructor of an interface pure virtual.</p>
<p>(and provide an implementation to make it compile).</p>
<p>An interface should not be instanciable, so forcing the destrutor to be pure is good.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SocketInterface</span> <span class="p">{</span>
<span class="nl">public:</span>
  <span class="c1">//pure virtual destructor</span>
  <span class="k">virtual</span> <span class="o">~</span><span class="n">SocketInterface</span><span class="p">()</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  <span class="k">virtual</span> <span class="kt">void</span> <span class="nf">onReadyRead</span><span class="p">();</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
<div class="section" id="global">
<h2>Global<a class="headerlink" href="#global" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Never define a global in a library that need code to run.</li>
<li>always define global static</li>
</ul>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">static</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">titi</span><span class="p">;</span>       <span class="c1">//bad because it call the constructor of std::string</span>
<span class="k">static</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">titi</span> <span class="o">=</span> <span class="s">&quot;toto&quot;</span><span class="p">;</span>    <span class="c1">//bad because it call the constructor of std::string</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">somefunction</span><span class="p">();</span> <span class="c1">//bad because it call somefunction</span>
<span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">tutu</span><span class="p">;</span>                    <span class="c1">//very very bad because it&#39;s not static to the file and call the constructor of std::string</span>
</pre></div>
</div>
<div class="highlight-c++"><div class="highlight"><pre><span class="k">static</span> <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="o">*</span><span class="n">titi</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// it&#39;s a pointer, so it does not call the std::string constructor</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="k">static</span> <span class="k">const</span> <span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="mf">2.</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="pointers">
<h3>** pointers<a class="headerlink" href="#pointers" title="Permalink to this headline">¶</a></h3>
<p>They should never be used to return data to users.
Implement fast copy constructor and operator=. Rely on swap semantic if needed.</p>
<dl class="docutils">
<dt>Rational:</dt>
<dd>Allocation should always be done in the same &#8220;space&#8221;, a library should malloc and free his structure, user code too. Under windows structure do not have the same size between debug and release, this lead to release library not usable in debug build.</dd>
</dl>
<p>** pointer should only be used as input parameter, to pass an array of pointer.</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">//BAD an object is created in the socket library, but should be released</span>
<span class="c1">//in the client program</span>
<span class="n">Message</span> <span class="o">*</span><span class="n">msg</span><span class="p">;</span>
<span class="n">socket</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-c++"><div class="highlight"><pre><span class="c1">//Good, user provide a message to fill</span>
<span class="n">Message</span> <span class="n">msg</span><span class="p">;</span>
<span class="n">socket</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="o">&amp;</span><span class="n">msg</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="assert-exit">
<h2>Assert/Exit<a class="headerlink" href="#assert-exit" title="Permalink to this headline">¶</a></h2>
<p>** Basically you should only use assert for something that according to you the developper when you write the assert CANNOT POSSIBLY BE FALSE.</p>
<ul class="simple">
<li>do not call assert when the error is not fatal.</li>
<li>never call exit in a library.</li>
</ul>
<p>Report error to the user of the library if possible instead. Users are then free to assert/exit as they want. A library should never crash a program delibarately.</p>
<p>assert is only active during debug, you may think that it is enough to use it, but Windows users use debug build (and some developer may too), and they do not want their program to crash because of a lib that do not handle errors correctly.</p>
<p>You should really be careful with assert, the goal is to catch error before a segfault, to point at the real error, instead of a random segfault. So use with caution.</p>
<p>A borderline example:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">inotify_event</span><span class="o">&amp;</span> <span class="n">evt</span> <span class="o">=</span> <span class="k">reinterpret_cast</span><span class="o">&lt;</span><span class="n">inotify_event</span><span class="o">&amp;&gt;</span><span class="p">(</span><span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">evt</span><span class="p">..</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">IN_CREATE</span><span class="p">)</span> <span class="p">{...}</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">evt</span><span class="p">.</span><span class="n">mask</span> <span class="o">&amp;</span> <span class="n">IN_STUFF</span><span class="p">)</span> <span class="p">{...}</span>
 <span class="o">&lt;</span><span class="p">..</span><span class="o">&gt;</span>
<span class="k">else</span> <span class="n">assert</span><span class="p">(</span><span class="o">!</span><span class="s">&quot;inotify event type unknown&quot;</span><span class="p">);</span>

<span class="c1">//this one is wrong, if inotify api evolves some new message types may appear. This can happen and is not fatal to the code.</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <div class="footernav">
    &laquo; <a href="network-binary-protocol.html" title="Network Binary Protocol">Network Binary Protocol</a>
     |
    <a href="index.html" title="Design Documents" accesskey="U">Design Documents</a></div>
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>


  <h3>Table Of Contents</h3>
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../guide/index.html">User Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Design Documents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="network-usecase.html">Networking - Use Case</a></li>
<li class="toctree-l2"><a class="reference internal" href="network-binary-protocol.html">Network Binary Protocol</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Coding Convention</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>

    <h3><a href="../index.html">On this page</a></h3>
    <ul>
<li><a class="reference internal" href="#">Coding Convention</a><ul>
<li><a class="reference internal" href="#backward-compatibility">Backward Compatibility</a></li>
<li><a class="reference internal" href="#naming-convention">Naming convention</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#headers">Headers</a></li>
<li><a class="reference internal" href="#header-include-statement">Header include statement</a></li>
<li><a class="reference internal" href="#export-symbol">Export symbol</a></li>
<li><a class="reference internal" href="#private-implementation">Private Implementation</a><ul>
<li><a class="reference internal" href="#example-with-pimpl">Example with Pimpl</a></li>
<li><a class="reference internal" href="#example-without-pimpl">Example without Pimpl</a></li>
</ul>
</li>
<li><a class="reference internal" href="#struct">Struct</a></li>
<li><a class="reference internal" href="#exception">Exception</a></li>
<li><a class="reference internal" href="#iterators">Iterators</a></li>
<li><a class="reference internal" href="#enum">Enum</a></li>
<li><a class="reference internal" href="#members">Members</a></li>
<li><a class="reference internal" href="#arguments">Arguments</a></li>
<li><a class="reference internal" href="#virtual">Virtual</a></li>
<li><a class="reference internal" href="#interface">Interface</a></li>
<li><a class="reference internal" href="#global">Global</a><ul>
<li><a class="reference internal" href="#pointers">** pointers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assert-exit">Assert/Exit</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
          </div>
        
      
    </div>

    <div id="ft">
      <div class="nav">
    &laquo; <a href="network-binary-protocol.html" title="Network Binary Protocol">previous</a>
     |
    <a href="index.html" title="Design Documents" accesskey="U">up</a></div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>